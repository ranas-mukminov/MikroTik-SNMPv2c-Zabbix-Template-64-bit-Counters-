<?xml version='1.0' encoding='UTF-8'?>
<zabbix_export version="7.0">
  <templates>
    <template>
      <uuid>8a9b7c6d5e4f3a2b1c0d9e8f7a6b5c4d</uuid>
      <template>Template_Mikrotik_SNMPv2c_Advanced</template>
      <name>Template MikroTik SNMPv2c Advanced (Production)</name>
      <description>Production-ready SNMPv2c template for MikroTik routers with comprehensive monitoring:
- Interface discovery with 64-bit counters, errors, discards, and utilization
- CPU and Memory monitoring
- Hardware health (temperature, voltage)
- RouterOS version and inventory
- ICMP availability monitoring
- OSPF and BGP protocol monitoring
- Broadcast/Multicast storm detection
- Advanced triggers with dependencies and hysteresis
- Graph prototypes for visualization

Optimized for Zabbix 7.0+ with modern tags and best practices.
Author: Network Engineering Team
Version: 2.0.0</description>
      <groups>
        <group>
          <name>Templates/Network devices</name>
        </group>
      </groups>
      <items>
        <!-- ICMP Availability Monitoring -->
        <item>
          <uuid>1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d</uuid>
          <name>ICMP ping</name>
          <type>SIMPLE</type>
          <key>icmpping</key>
          <delay>30s</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>UNSIGNED</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>network</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>health</value>
            </tag>
          </tags>
          <description>Device availability check via ICMP ping (0=unreachable, 1=reachable)</description>
        </item>
        <item>
          <uuid>2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e</uuid>
          <name>ICMP response time</name>
          <type>SIMPLE</type>
          <key>icmppingsec</key>
          <delay>30s</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>s</units>
          <tags>
            <tag>
              <tag>class</tag>
              <value>network</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>health</value>
            </tag>
          </tags>
          <description>ICMP ping response time in seconds</description>
        </item>
        <item>
          <uuid>3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f</uuid>
          <name>ICMP packet loss</name>
          <type>SIMPLE</type>
          <key>icmppingloss</key>
          <delay>30s</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <tags>
            <tag>
              <tag>class</tag>
              <value>network</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>health</value>
            </tag>
          </tags>
          <description>ICMP ping packet loss percentage</description>
        </item>

        <!-- System Monitoring -->
        <item>
          <uuid>4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a</uuid>
          <name>SNMP agent availability</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
          <key>system.uptime[sysUpTime]</key>
          <delay>1m</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>s</units>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>uptime</value>
            </tag>
          </tags>
          <description>Device uptime in seconds (converted from SNMP timeticks)</description>
        </item>
        <item>
          <uuid>5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b</uuid>
          <name>System description</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysDescr.0</snmp_oid>
          <key>system.descr[sysDescr]</key>
          <delay>1h</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>inventory</value>
            </tag>
          </tags>
          <description>Full system description from SNMP agent</description>
        </item>
        <item>
          <uuid>6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c</uuid>
          <name>System name</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysName.0</snmp_oid>
          <key>system.name</key>
          <delay>1h</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>inventory</value>
            </tag>
          </tags>
          <description>Device hostname</description>
        </item>
        <item>
          <uuid>7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d</uuid>
          <name>System location</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysLocation.0</snmp_oid>
          <key>system.location</key>
          <delay>1h</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>inventory</value>
            </tag>
          </tags>
          <description>Physical location of the device</description>
        </item>
        <item>
          <uuid>8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e</uuid>
          <name>System contact</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysContact.0</snmp_oid>
          <key>system.contact</key>
          <delay>1h</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>inventory</value>
            </tag>
          </tags>
          <description>Contact information for device administrator</description>
        </item>

        <!-- CPU and Memory Monitoring -->
        <item>
          <uuid>9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f</uuid>
          <name>CPU utilization</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrProcessorLoad.1</snmp_oid>
          <key>system.cpu.util</key>
          <delay>1m</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>cpu</value>
            </tag>
          </tags>
          <description>CPU utilization percentage</description>
        </item>
        <item>
          <uuid>0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a</uuid>
          <name>Total memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrMemorySize.0</snmp_oid>
          <key>vm.memory.total</key>
          <delay>1h</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>UNSIGNED</value_type>
          <units>B</units>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>memory</value>
            </tag>
          </tags>
          <description>Total memory available in bytes</description>
        </item>
        <item>
          <uuid>1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b</uuid>
          <name>Used memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrStorageUsed.1</snmp_oid>
          <key>vm.memory.used</key>
          <delay>1m</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>UNSIGNED</value_type>
          <units>B</units>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>memory</value>
            </tag>
          </tags>
          <description>Used memory in bytes</description>
        </item>
        <item>
          <uuid>2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c</uuid>
          <name>Memory utilization</name>
          <type>CALCULATED</type>
          <key>vm.memory.util</key>
          <delay>1m</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <params>(last(//vm.memory.used)/last(//vm.memory.total))*100</params>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>memory</value>
            </tag>
          </tags>
          <description>Memory utilization percentage</description>
        </item>

        <!-- MikroTik-specific Hardware Health -->
        <item>
          <uuid>3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d</uuid>
          <name>System temperature</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.14988.1.1.3.10.0</snmp_oid>
          <key>sensor.temp.value</key>
          <delay>5m</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>Â°C</units>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
          <tags>
            <tag>
              <tag>class</tag>
              <value>hardware</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>temperature</value>
            </tag>
          </tags>
          <description>System temperature in Celsius (MikroTik-specific OID)</description>
        </item>
        <item>
          <uuid>4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e</uuid>
          <name>System voltage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.14988.1.1.3.8.0</snmp_oid>
          <key>sensor.voltage.value</key>
          <delay>5m</delay>
          <history>7d</history>
          <trends>90d</trends>
          <value_type>FLOAT</value_type>
          <units>V</units>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
          <tags>
            <tag>
              <tag>class</tag>
              <value>hardware</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>power</value>
            </tag>
          </tags>
          <description>System voltage in volts (MikroTik-specific OID)</description>
        </item>
        <item>
          <uuid>5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f</uuid>
          <name>RouterOS version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.14988.1.1.4.4.0</snmp_oid>
          <key>system.sw.os.version</key>
          <delay>1d</delay>
          <history>30d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>system</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>os</value>
            </tag>
          </tags>
          <description>RouterOS version (MikroTik-specific OID)</description>
        </item>
        <item>
          <uuid>6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a</uuid>
          <name>Serial number</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.14988.1.1.7.3.0</snmp_oid>
          <key>system.hw.serialnumber</key>
          <delay>1d</delay>
          <history>30d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <tags>
            <tag>
              <tag>class</tag>
              <value>hardware</value>
            </tag>
            <tag>
              <tag>target</tag>
              <value>mikrotik</value>
            </tag>
            <tag>
              <tag>component</tag>
              <value>inventory</value>
            </tag>
          </tags>
          <description>Device serial number (MikroTik-specific OID)</description>
        </item>
      </items>

      <discovery_rules>
        <!-- Network Interface Discovery -->
        <discovery_rule>
          <uuid>7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b</uuid>
          <name>Network interface discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IFINDEX},IF-MIB::ifIndex,{#IFDESCR},IF-MIB::ifDescr,{#IFNAME},IF-MIB::ifName,{#IFTYPE},IF-MIB::ifType,{#IFALIAS},IF-MIB::ifAlias,{#IFADMINSTATUS},IF-MIB::ifAdminStatus]</snmp_oid>
          <key>net.if.discovery</key>
          <delay>{$IF.DISCOVERY.INTERVAL}</delay>
          <lifetime>7d</lifetime>
          <description>Discovers network interfaces with comprehensive metadata for filtering and monitoring</description>
          <filter>
            <formula>A&amp;B&amp;C</formula>
            <conditions>
              <condition>
                <macro>{#IFDESCR}</macro>
                <operator>MATCHES_REGEX</operator>
                <value>{$IF.LLD.FILTER.MATCH}</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#IFDESCR}</macro>
                <operator>NOT_MATCHES_REGEX</operator>
                <value>{$IF.LLD.FILTER.NOT_MATCHES}</value>
                <formulaid>B</formulaid>
              </condition>
              <condition>
                <macro>{#IFADMINSTATUS}</macro>
                <operator>MATCHES_REGEX</operator>
                <value>{$IF.LLD.FILTER.ADMIN_STATUS}</value>
                <formulaid>C</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <!-- Bandwidth Monitoring -->
            <item_prototype>
              <uuid>8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c</uuid>
              <name>{#IFDESCR}: Inbound bandwidth</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifHCInOctets.{#IFINDEX}</snmp_oid>
              <key>net.if.in[{#IFINDEX}]</key>
              <delay>{$IF.POLL.INTERVAL}</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <units>bps</units>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>64-bit inbound traffic converted to bits per second</description>
            </item_prototype>
            <item_prototype>
              <uuid>9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d</uuid>
              <name>{#IFDESCR}: Outbound bandwidth</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifHCOutOctets.{#IFINDEX}</snmp_oid>
              <key>net.if.out[{#IFINDEX}]</key>
              <delay>{$IF.POLL.INTERVAL}</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <units>bps</units>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>64-bit outbound traffic converted to bits per second</description>
            </item_prototype>

            <!-- Interface Status -->
            <item_prototype>
              <uuid>0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e</uuid>
              <name>{#IFDESCR}: Operational status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOperStatus.{#IFINDEX}</snmp_oid>
              <key>net.if.status[{#IFINDEX}]</key>
              <delay>30s</delay>
              <history>30d</history>
              <trends>0</trends>
              <value_type>UNSIGNED</value_type>
              <valuemap>
                <name>IF-MIB::ifOperStatus</name>
              </valuemap>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Interface operational status (1=up, 2=down, etc.)</description>
            </item_prototype>

            <!-- Error Monitoring -->
            <item_prototype>
              <uuid>1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f</uuid>
              <name>{#IFDESCR}: Inbound errors</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInErrors.{#IFINDEX}</snmp_oid>
              <key>net.if.in.errors[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Inbound error rate per second</description>
            </item_prototype>
            <item_prototype>
              <uuid>2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a</uuid>
              <name>{#IFDESCR}: Outbound errors</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutErrors.{#IFINDEX}</snmp_oid>
              <key>net.if.out.errors[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Outbound error rate per second</description>
            </item_prototype>

            <!-- Discard Monitoring (NEW) -->
            <item_prototype>
              <uuid>3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b</uuid>
              <name>{#IFDESCR}: Inbound discards</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInDiscards.{#IFINDEX}</snmp_oid>
              <key>net.if.in.discards[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Inbound discarded packets rate per second (buffer overflow indicator)</description>
            </item_prototype>
            <item_prototype>
              <uuid>4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c</uuid>
              <name>{#IFDESCR}: Outbound discards</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutDiscards.{#IFINDEX}</snmp_oid>
              <key>net.if.out.discards[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Outbound discarded packets rate per second (QoS/buffer indicator)</description>
            </item_prototype>

            <!-- Broadcast/Multicast Monitoring (NEW) -->
            <item_prototype>
              <uuid>5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d</uuid>
              <name>{#IFDESCR}: Inbound broadcast packets</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifHCInBroadcastPkts.{#IFINDEX}</snmp_oid>
              <key>net.if.in.broadcast[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Inbound broadcast packets rate per second</description>
            </item_prototype>
            <item_prototype>
              <uuid>6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e</uuid>
              <name>{#IFDESCR}: Inbound multicast packets</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifHCInMulticastPkts.{#IFINDEX}</snmp_oid>
              <key>net.if.in.multicast[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params/>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Inbound multicast packets rate per second</description>
            </item_prototype>

            <!-- Interface Metadata -->
            <item_prototype>
              <uuid>7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f</uuid>
              <name>{#IFDESCR}: Alias</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifAlias.{#IFINDEX}</snmp_oid>
              <key>net.if.alias[{#IFINDEX}]</key>
              <delay>1h</delay>
              <history>30d</history>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Interface alias/description from device configuration</description>
            </item_prototype>
            <item_prototype>
              <uuid>8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a</uuid>
              <name>{#IFDESCR}: Configured speed</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifHighSpeed.{#IFINDEX}</snmp_oid>
              <key>net.if.highspeed[{#IFINDEX}]</key>
              <delay>5m</delay>
              <history>30d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <units>bps</units>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>1000000</params>
                </step>
              </preprocessing>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Configured interface bandwidth (Mbps to bps) for capacity planning</description>
            </item_prototype>

            <!-- Bandwidth Utilization (CALCULATED - NEW) -->
            <item_prototype>
              <uuid>9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b</uuid>
              <name>{#IFDESCR}: Inbound bandwidth utilization</name>
              <type>CALCULATED</type>
              <key>net.if.in.util[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <units>%</units>
              <params>(last(//net.if.in[{#IFINDEX}])/last(//net.if.highspeed[{#IFINDEX}]))*100</params>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Inbound bandwidth utilization as percentage of configured speed</description>
            </item_prototype>
            <item_prototype>
              <uuid>0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c</uuid>
              <name>{#IFDESCR}: Outbound bandwidth utilization</name>
              <type>CALCULATED</type>
              <key>net.if.out.util[{#IFINDEX}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>FLOAT</value_type>
              <units>%</units>
              <params>(last(//net.if.out[{#IFINDEX}])/last(//net.if.highspeed[{#IFINDEX}]))*100</params>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>interface</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
              <description>Outbound bandwidth utilization as percentage of configured speed</description>
            </item_prototype>
          </item_prototypes>

          <trigger_prototypes>
            <!-- Interface Down Trigger with Hysteresis and Dependency -->
            <trigger_prototype>
              <uuid>1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d</uuid>
              <expression>{Template_Mikrotik_SNMPv2c_Advanced:net.if.status[{#IFINDEX}].last()}=2 and {Template_Mikrotik_SNMPv2c_Advanced:net.if.status[{#IFINDEX}].count(2m,2)}&gt;1</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{Template_Mikrotik_SNMPv2c_Advanced:net.if.status[{#IFINDEX}].last()}=1</recovery_expression>
              <name>{#IFDESCR}: Interface is down</name>
              <priority>AVERAGE</priority>
              <description>Interface operational status is down (with 2-minute confirmation to avoid flapping alerts)</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>Device is unreachable via ICMP</name>
                  <expression>{Template_Mikrotik_SNMPv2c_Advanced:icmpping.max(5m)}=0</expression>
                </dependency>
              </dependencies>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>availability</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
            </trigger_prototype>

            <!-- High Error Rate Trigger -->
            <trigger_prototype>
              <uuid>2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e</uuid>
              <expression>({Template_Mikrotik_SNMPv2c_Advanced:net.if.in.errors[{#IFINDEX}].max(5m)}&gt;{$IF.ERRORS.MAX_DELTA}) or ({Template_Mikrotik_SNMPv2c_Advanced:net.if.out.errors[{#IFINDEX}].max(5m)}&gt;{$IF.ERRORS.MAX_DELTA})</expression>
              <name>{#IFDESCR}: High error rate</name>
              <priority>WARNING</priority>
              <description>Interface error rate exceeds threshold (physical layer issues possible)</description>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>performance</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
            </trigger_prototype>

            <!-- High Discard Rate Trigger (NEW) -->
            <trigger_prototype>
              <uuid>3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f</uuid>
              <expression>({Template_Mikrotik_SNMPv2c_Advanced:net.if.in.discards[{#IFINDEX}].max(5m)}&gt;{$IF.DISCARDS.MAX_DELTA}) or ({Template_Mikrotik_SNMPv2c_Advanced:net.if.out.discards[{#IFINDEX}].max(5m)}&gt;{$IF.DISCARDS.MAX_DELTA})</expression>
              <name>{#IFDESCR}: High packet discard rate</name>
              <priority>WARNING</priority>
              <description>Interface discard rate exceeds threshold (buffer overflow or QoS drops)</description>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>performance</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
            </trigger_prototype>

            <!-- Bandwidth Utilization Triggers (NEW) -->
            <trigger_prototype>
              <uuid>4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a</uuid>
              <expression>({Template_Mikrotik_SNMPv2c_Advanced:net.if.in.util[{#IFINDEX}].avg(15m)}&gt;95) or ({Template_Mikrotik_SNMPv2c_Advanced:net.if.out.util[{#IFINDEX}].avg(15m)}&gt;95)</expression>
              <name>{#IFDESCR}: Critical bandwidth utilization (&gt;95%)</name>
              <priority>HIGH</priority>
              <description>Interface bandwidth utilization is critical (&gt;95% for 15 minutes) - capacity upgrade needed</description>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>capacity</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
            </trigger_prototype>
            <trigger_prototype>
              <uuid>5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b</uuid>
              <expression>({Template_Mikrotik_SNMPv2c_Advanced:net.if.in.util[{#IFINDEX}].avg(15m)}&gt;80) or ({Template_Mikrotik_SNMPv2c_Advanced:net.if.out.util[{#IFINDEX}].avg(15m)}&gt;80)</expression>
              <name>{#IFDESCR}: High bandwidth utilization (&gt;80%)</name>
              <priority>WARNING</priority>
              <description>Interface bandwidth utilization is high (&gt;80% for 15 minutes) - monitor for capacity planning</description>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>capacity</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
            </trigger_prototype>

            <!-- Broadcast Storm Detection (NEW) -->
            <trigger_prototype>
              <uuid>6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c</uuid>
              <expression>{Template_Mikrotik_SNMPv2c_Advanced:net.if.in.broadcast[{#IFINDEX}].avg(5m)}&gt;{$IF.BROADCAST.MAX_PPS}</expression>
              <name>{#IFDESCR}: Broadcast storm detected</name>
              <priority>WARNING</priority>
              <description>Excessive broadcast traffic detected (&gt;{$IF.BROADCAST.MAX_PPS} pps) - possible network loop or misconfiguration</description>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>security</value>
                </tag>
                <tag>
                  <tag>interface</tag>
                  <value>{#IFDESCR}</value>
                </tag>
              </tags>
            </trigger_prototype>
          </trigger_prototypes>

          <graph_prototypes>
            <!-- Traffic Graph -->
            <graph_prototype>
              <uuid>7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d</uuid>
              <name>{#IFDESCR}: Traffic</name>
              <graph_items>
                <graph_item>
                  <color>00AA00</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.in[{#IFINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>0000AA</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.out[{#IFINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>

            <!-- Bandwidth Utilization Graph -->
            <graph_prototype>
              <uuid>8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e</uuid>
              <name>{#IFDESCR}: Bandwidth utilization</name>
              <ymin_type_1>FIXED</ymin_type_1>
              <ymax_type_1>FIXED</ymax_type_1>
              <ymax_item_1>100</ymax_item_1>
              <graph_items>
                <graph_item>
                  <color>00CC00</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.in.util[{#IFINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>0000CC</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.out.util[{#IFINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>

            <!-- Errors and Discards Graph -->
            <graph_prototype>
              <uuid>9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f</uuid>
              <name>{#IFDESCR}: Errors and discards</name>
              <graph_items>
                <graph_item>
                  <color>FF0000</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.in.errors[{#IFINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>DD0000</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.out.errors[{#IFINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>2</sortorder>
                  <color>FF8800</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.in.discards[{#IFINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>3</sortorder>
                  <color>DD6600</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.out.discards[{#IFINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>

            <!-- Broadcast/Multicast Graph -->
            <graph_prototype>
              <uuid>0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a</uuid>
              <name>{#IFDESCR}: Broadcast and multicast traffic</name>
              <graph_items>
                <graph_item>
                  <color>FF00FF</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.in.broadcast[{#IFINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>00FFFF</color>
                  <item>
                    <host>Template_Mikrotik_SNMPv2c_Advanced</host>
                    <key>net.if.in.multicast[{#IFINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>

        <!-- OSPF Neighbor Discovery (NEW) -->
        <discovery_rule>
          <uuid>1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b</uuid>
          <name>OSPF neighbors discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#OSPF.NBR.ADDR},OSPF-MIB::ospfNbrIpAddr,{#OSPF.NBR.RTR},OSPF-MIB::ospfNbrRtrId]</snmp_oid>
          <key>ospf.neighbors.discovery</key>
          <delay>10m</delay>
          <lifetime>7d</lifetime>
          <description>Discovers OSPF neighbors for adjacency monitoring</description>
          <item_prototypes>
            <item_prototype>
              <uuid>2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c</uuid>
              <name>OSPF neighbor {#OSPF.NBR.ADDR}: State</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>OSPF-MIB::ospfNbrState.{#OSPF.NBR.ADDR}</snmp_oid>
              <key>ospf.neighbor.state[{#OSPF.NBR.ADDR}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>UNSIGNED</value_type>
              <valuemap>
                <name>OSPF-MIB::ospfNbrState</name>
              </valuemap>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>ospf</value>
                </tag>
                <tag>
                  <tag>neighbor</tag>
                  <value>{#OSPF.NBR.ADDR}</value>
                </tag>
              </tags>
              <description>OSPF neighbor state (8=Full is normal)</description>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <uuid>3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d</uuid>
              <expression>{Template_Mikrotik_SNMPv2c_Advanced:ospf.neighbor.state[{#OSPF.NBR.ADDR}].last()}&lt;&gt;8 and {Template_Mikrotik_SNMPv2c_Advanced:ospf.neighbor.state[{#OSPF.NBR.ADDR}].count(3m,8)}&lt;1</expression>
              <name>OSPF neighbor {#OSPF.NBR.ADDR} ({#OSPF.NBR.RTR}) is not in Full state</name>
              <priority>AVERAGE</priority>
              <description>OSPF neighbor adjacency is not fully established (not in Full state for 3 minutes)</description>
              <manual_close>YES</manual_close>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>availability</value>
                </tag>
                <tag>
                  <tag>neighbor</tag>
                  <value>{#OSPF.NBR.ADDR}</value>
                </tag>
              </tags>
            </trigger_prototype>
          </trigger_prototypes>
        </discovery_rule>

        <!-- BGP Peer Discovery (NEW) -->
        <discovery_rule>
          <uuid>4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e</uuid>
          <name>BGP peers discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#BGP.PEER.ADDR},BGP4-MIB::bgpPeerRemoteAddr,{#BGP.PEER.AS},BGP4-MIB::bgpPeerRemoteAs]</snmp_oid>
          <key>bgp.peers.discovery</key>
          <delay>10m</delay>
          <lifetime>7d</lifetime>
          <description>Discovers BGP peers for session monitoring</description>
          <item_prototypes>
            <item_prototype>
              <uuid>5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f</uuid>
              <name>BGP peer {#BGP.PEER.ADDR} (AS{#BGP.PEER.AS}): State</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>BGP4-MIB::bgpPeerState.{#BGP.PEER.ADDR}</snmp_oid>
              <key>bgp.peer.state[{#BGP.PEER.ADDR}]</key>
              <delay>1m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>UNSIGNED</value_type>
              <valuemap>
                <name>BGP4-MIB::bgpPeerState</name>
              </valuemap>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>bgp</value>
                </tag>
                <tag>
                  <tag>peer</tag>
                  <value>{#BGP.PEER.ADDR}</value>
                </tag>
              </tags>
              <description>BGP peer state (6=Established is normal)</description>
            </item_prototype>
            <item_prototype>
              <uuid>6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a</uuid>
              <name>BGP peer {#BGP.PEER.ADDR} (AS{#BGP.PEER.AS}): Received prefixes</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>BGP4-MIB::bgpPeerInTotalMessages.{#BGP.PEER.ADDR}</snmp_oid>
              <key>bgp.peer.prefixes[{#BGP.PEER.ADDR}]</key>
              <delay>5m</delay>
              <history>7d</history>
              <trends>90d</trends>
              <value_type>UNSIGNED</value_type>
              <tags>
                <tag>
                  <tag>class</tag>
                  <value>network</value>
                </tag>
                <tag>
                  <tag>target</tag>
                  <value>mikrotik</value>
                </tag>
                <tag>
                  <tag>component</tag>
                  <value>bgp</value>
                </tag>
                <tag>
                  <tag>peer</tag>
                  <value>{#BGP.PEER.ADDR}</value>
                </tag>
              </tags>
              <description>Total messages received from BGP peer</description>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <uuid>7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b</uuid>
              <expression>{Template_Mikrotik_SNMPv2c_Advanced:bgp.peer.state[{#BGP.PEER.ADDR}].last()}&lt;&gt;6 and {Template_Mikrotik_SNMPv2c_Advanced:bgp.peer.state[{#BGP.PEER.ADDR}].count(5m,6)}&lt;1</expression>
              <name>BGP peer {#BGP.PEER.ADDR} (AS{#BGP.PEER.AS}) is not established</name>
              <priority>AVERAGE</priority>
              <description>BGP peer session is not in Established state for 5 minutes</description>
              <manual_close>YES</manual_close>
              <tags>
                <tag>
                  <tag>scope</tag>
                  <value>availability</value>
                </tag>
                <tag>
                  <tag>peer</tag>
                  <value>{#BGP.PEER.ADDR}</value>
                </tag>
              </tags>
            </trigger_prototype>
          </trigger_prototypes>
        </discovery_rule>
      </discovery_rules>

      <triggers>
        <!-- ICMP Availability Trigger -->
        <trigger>
          <uuid>8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:icmpping.max(5m)}=0</expression>
          <name>Device is unreachable via ICMP</name>
          <priority>HIGH</priority>
          <description>Device does not respond to ICMP ping for 5 minutes</description>
          <manual_close>YES</manual_close>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>availability</value>
            </tag>
          </tags>
        </trigger>

        <!-- ICMP Packet Loss Trigger -->
        <trigger>
          <uuid>9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:icmppingloss.avg(5m)}&gt;{$ICMP.LOSS.WARN}</expression>
          <name>High ICMP packet loss (&gt;{$ICMP.LOSS.WARN}%)</name>
          <priority>WARNING</priority>
          <description>ICMP packet loss exceeds warning threshold - possible network connectivity issues</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>performance</value>
            </tag>
          </tags>
        </trigger>

        <!-- CPU Utilization Triggers -->
        <trigger>
          <uuid>0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:system.cpu.util.avg(5m)}&gt;{$CPU.UTIL.CRIT}</expression>
          <name>Critical CPU utilization (&gt;{$CPU.UTIL.CRIT}% for 5m)</name>
          <priority>HIGH</priority>
          <description>CPU utilization is critically high - investigate high-load processes</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>performance</value>
            </tag>
          </tags>
        </trigger>
        <trigger>
          <uuid>1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:system.cpu.util.avg(5m)}&gt;{$CPU.UTIL.WARN}</expression>
          <name>High CPU utilization (&gt;{$CPU.UTIL.WARN}% for 5m)</name>
          <priority>WARNING</priority>
          <description>CPU utilization is high - monitor for capacity planning</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>performance</value>
            </tag>
          </tags>
        </trigger>

        <!-- Memory Utilization Triggers -->
        <trigger>
          <uuid>2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:vm.memory.util.avg(5m)}&gt;{$MEM.UTIL.CRIT}</expression>
          <name>Critical memory utilization (&gt;{$MEM.UTIL.CRIT}%)</name>
          <priority>HIGH</priority>
          <description>Memory utilization is critically high - device may become unstable</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>performance</value>
            </tag>
          </tags>
        </trigger>
        <trigger>
          <uuid>3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:vm.memory.util.avg(5m)}&gt;{$MEM.UTIL.WARN}</expression>
          <name>High memory utilization (&gt;{$MEM.UTIL.WARN}%)</name>
          <priority>WARNING</priority>
          <description>Memory utilization is high - monitor for capacity planning</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>performance</value>
            </tag>
          </tags>
        </trigger>

        <!-- Temperature Trigger -->
        <trigger>
          <uuid>4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:sensor.temp.value.avg(5m)}&gt;{$TEMP.MAX.CRIT}</expression>
          <name>Critical system temperature (&gt;{$TEMP.MAX.CRIT}Â°C)</name>
          <priority>HIGH</priority>
          <description>System temperature is critically high - check cooling and environment</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>health</value>
            </tag>
          </tags>
        </trigger>
        <trigger>
          <uuid>5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:sensor.temp.value.avg(5m)}&gt;{$TEMP.MAX.WARN}</expression>
          <name>High system temperature (&gt;{$TEMP.MAX.WARN}Â°C)</name>
          <priority>WARNING</priority>
          <description>System temperature is elevated - monitor cooling system</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>health</value>
            </tag>
          </tags>
        </trigger>

        <!-- Voltage Trigger -->
        <trigger>
          <uuid>6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:sensor.voltage.value.avg(5m)}&lt;{$VOLTAGE.MIN} or {Template_Mikrotik_SNMPv2c_Advanced:sensor.voltage.value.avg(5m)}&gt;{$VOLTAGE.MAX}</expression>
          <name>Abnormal system voltage</name>
          <priority>AVERAGE</priority>
          <description>System voltage is outside normal range - check power supply</description>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>health</value>
            </tag>
          </tags>
        </trigger>

        <!-- Device Restart Trigger -->
        <trigger>
          <uuid>7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f</uuid>
          <expression>{Template_Mikrotik_SNMPv2c_Advanced:system.uptime[sysUpTime].last()}&lt;10m</expression>
          <name>Device has been restarted</name>
          <priority>INFO</priority>
          <description>Device uptime is less than 10 minutes - recent restart detected</description>
          <manual_close>YES</manual_close>
          <tags>
            <tag>
              <tag>scope</tag>
              <value>availability</value>
            </tag>
          </tags>
        </trigger>
      </triggers>

      <macros>
        <!-- SNMP Configuration -->
        <macro>
          <macro>{$SNMP_COMMUNITY}</macro>
          <value>CHANGE_ME_SNMPV2C</value>
          <description>â ï¸ SECURITY: Change this to your private SNMP community string! Default 'public' is a security risk!</description>
        </macro>

        <!-- Interface Discovery Filters -->
        <macro>
          <macro>{$IF.LLD.FILTER.MATCH}</macro>
          <value>.*</value>
          <description>Regex to include interfaces during discovery (default: all)</description>
        </macro>
        <macro>
          <macro>{$IF.LLD.FILTER.NOT_MATCHES}</macro>
          <value>(?i:loopback|virtual|vlan|gre|pppoe|eoip|6to4)</value>
          <description>Regex to exclude interfaces during discovery (virtual/tunnel interfaces)</description>
        </macro>
        <macro>
          <macro>{$IF.LLD.FILTER.ADMIN_STATUS}</macro>
          <value>^1$</value>
          <description>Admin status filter for discovery (1=up, 2=down, 3=testing)</description>
        </macro>

        <!-- Polling Intervals -->
        <macro>
          <macro>{$IF.POLL.INTERVAL}</macro>
          <value>1m</value>
          <description>Interface polling interval (1m default, 30s for critical links)</description>
        </macro>
        <macro>
          <macro>{$IF.DISCOVERY.INTERVAL}</macro>
          <value>30m</value>
          <description>Interface discovery interval (default: 30 minutes)</description>
        </macro>

        <!-- Interface Thresholds -->
        <macro>
          <macro>{$IF.ERRORS.MAX_DELTA}</macro>
          <value>1</value>
          <description>Maximum tolerated interface errors per second</description>
        </macro>
        <macro>
          <macro>{$IF.DISCARDS.MAX_DELTA}</macro>
          <value>10</value>
          <description>Maximum tolerated interface discards per second</description>
        </macro>
        <macro>
          <macro>{$IF.BROADCAST.MAX_PPS}</macro>
          <value>1000</value>
          <description>Maximum broadcast packets per second (storm detection threshold)</description>
        </macro>

        <!-- CPU/Memory Thresholds -->
        <macro>
          <macro>{$CPU.UTIL.WARN}</macro>
          <value>80</value>
          <description>CPU utilization warning threshold (%)</description>
        </macro>
        <macro>
          <macro>{$CPU.UTIL.CRIT}</macro>
          <value>90</value>
          <description>CPU utilization critical threshold (%)</description>
        </macro>
        <macro>
          <macro>{$MEM.UTIL.WARN}</macro>
          <value>85</value>
          <description>Memory utilization warning threshold (%)</description>
        </macro>
        <macro>
          <macro>{$MEM.UTIL.CRIT}</macro>
          <value>95</value>
          <description>Memory utilization critical threshold (%)</description>
        </macro>

        <!-- Hardware Health Thresholds -->
        <macro>
          <macro>{$TEMP.MAX.WARN}</macro>
          <value>60</value>
          <description>Temperature warning threshold (Â°C)</description>
        </macro>
        <macro>
          <macro>{$TEMP.MAX.CRIT}</macro>
          <value>75</value>
          <description>Temperature critical threshold (Â°C)</description>
        </macro>
        <macro>
          <macro>{$VOLTAGE.MIN}</macro>
          <value>11</value>
          <description>Minimum acceptable voltage (V) - adjust for your device</description>
        </macro>
        <macro>
          <macro>{$VOLTAGE.MAX}</macro>
          <value>26</value>
          <description>Maximum acceptable voltage (V) - adjust for your device</description>
        </macro>

        <!-- ICMP Thresholds -->
        <macro>
          <macro>{$ICMP.LOSS.WARN}</macro>
          <value>20</value>
          <description>ICMP packet loss warning threshold (%)</description>
        </macro>
      </macros>
    </template>
  </templates>

  <value_maps>
    <!-- Interface Operational Status -->
    <value_map>
      <uuid>1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d</uuid>
      <name>IF-MIB::ifOperStatus</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>up</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>testing</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>unknown</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>dormant</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>notPresent</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>lowerLayerDown</newvalue>
        </mapping>
      </mappings>
    </value_map>

    <!-- OSPF Neighbor State -->
    <value_map>
      <uuid>2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e</uuid>
      <name>OSPF-MIB::ospfNbrState</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>attempt</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>init</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>twoWay</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>exchangeStart</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>exchange</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>loading</newvalue>
        </mapping>
        <mapping>
          <value>8</value>
          <newvalue>full</newvalue>
        </mapping>
      </mappings>
    </value_map>

    <!-- BGP Peer State -->
    <value_map>
      <uuid>3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f</uuid>
      <name>BGP4-MIB::bgpPeerState</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>idle</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>connect</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>active</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>opensent</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>openconfirm</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>established</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>
